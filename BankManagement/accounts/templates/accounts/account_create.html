{% extends 'accounts/base.html' %}

{% block title %}Create Account - SecureBank{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header text-center">
                <h3 class="mb-0"><i class="bi bi-person-plus"></i> Create New Bank Account  </h3>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-person"></i> First Name *
                            </label>
                            {{ form.first_name }}
                            {% if form.first_name.errors %}
                                <div class="text-danger small">{{ form.first_name.errors }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-person"></i> Last Name *
                            </label>
                            {{ form.last_name }}
                            {% if form.last_name.errors %}
                                <div class="text-danger small">{{ form.last_name.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-envelope"></i> Email *
                            </label>
                            {{ form.email }}
                            {% if form.email.errors %}
                                <div class="text-danger small">{{ form.email.errors }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-telephone"></i> Phone *
                            </label>
                            {{ form.phone }}
                            {% if form.phone.errors %}
                                <div class="text-danger small">{{ form.phone.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">
                            <i class="bi bi-geo-alt"></i> Address *
                        </label>
                        {{ form.address }}
                        {% if form.address.errors %}
                            <div class="text-danger small">{{ form.address.errors }}</div>
                        {% endif %}
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-calendar"></i> Date of Birth *
                            </label>
                            {{ form.date_of_birth }}
                            {% if form.date_of_birth.errors %}
                                <div class="text-danger small">{{ form.date_of_birth.errors }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-bank"></i> Account Type *
                            </label>
                            {{ form.account_type }}
                            {% if form.account_type.errors %}
                                <div class="text-danger small">{{ form.account_type.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">
                            <i class="bi bi-image"></i> Profile Picture (Optional)
                        </label>
                        {{ form.profile_picture }}
                        {% if form.profile_picture.help_text %}
                            <small class="form-text text-muted d-block mt-1">
                                <i class="bi bi-info-circle"></i> {{ form.profile_picture.help_text }}
                            </small>
                        {% endif %}
                        {% if form.profile_picture.errors %}
                            <div class="text-danger small mt-1">{{ form.profile_picture.errors }}</div>
                        {% endif %}
                        <div id="imagePreview" class="mt-3" style="display: none;">
                            <img id="previewImg" src="#" alt="Preview" class="img-thumbnail" style="max-width: 200px; max-height: 200px; border-radius: 10px;">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-lock"></i> PIN (4 digits) *
                            </label>
                            {{ form.pin }}
                            <small class="form-text text-muted">{{ form.pin.help_text }}</small>
                            {% if form.pin.errors %}
                                <div class="text-danger small">{{ form.pin.errors }}</div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                                <i class="bi bi-lock-fill"></i> Confirm PIN *
                            </label>
                            {{ form.confirm_pin }}
                            {% if form.confirm_pin.errors %}
                                <div class="text-danger small">{{ form.confirm_pin.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            <i class="bi bi-exclamation-triangle"></i> {{ form.non_field_errors }}
                        </div>
                    {% endif %}
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="bi bi-check-circle"></i> Create Account
                        </button>
                        <a href="{% url 'accounts:account_login' %}" class="btn btn-secondary">
                            <i class="bi bi-arrow-left"></i> Back to Login
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Preview image before upload
    document.querySelector('input[type="file"]').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('previewImg').src = e.target.result;
                document.getElementById('imagePreview').style.display = 'block';
            }
            reader.readAsDataURL(file);
        } else {
            document.getElementById('imagePreview').style.display = 'none';
        }
    });
</script>
{% endblock %}
